\documentclass[14pt]{extarticle}

%
% Layout
%

\usepackage{geometry}
\geometry{paper=a4paper}
\geometry{left=3cm,right=1cm,top=2cm,bottom=2cm}

%
% Font
%

\usepackage{fontspec}
\setmainfont{XITS}

%
% Paragraphs
%

\usepackage{indentfirst}

% Set the first line indent of a paragraph
\setlength\parindent{1.25cm}

% Set the line spacing to Microsoft Word's 1.5
\linespread{1.424}

% Turn off hyphenation
\hyphenpenalty=10000
\exhyphenpenalty=10000

% Justify text
\tolerance=1
\emergencystretch=\maxdimen
\hbadness=10000
\frenchspacing

%
% Localization
%

\usepackage[shorthands=off,english,russian]{babel}

% Set Russian and English alphabets for enumerations
\makeatletter
\def\russian@alph#1{\ifcase#1\or  % The letters Ё, З, Й, О, Ч, Ъ, Ы, Ь
  а\or б\or в\or г\or д\or        % are skipped (see "ГОСТ Р 2.105-2019"
  е\or ж\or и\or к\or л\or        % p. 6.3.5)
  м\or н\or п\or р\or с\or
  т\or у\or ф\or х\or ц\or
  ш\or щ\or э\or ю\or я\else\@ctrerr\fi}
\def\russian@Alph#1{\ifcase#1\or
  А\or Б\or В\or Г\or Д\or
  Е\or Ж\or И\or К\or Л\or
  М\or Н\or П\or Р\or С\or
  Т\or У\or Ф\or Х\or Ц\or
  Ш\or Щ\or Э\or Ю\or Я\else\@ctrerr\fi}
\def\@alph#1{\ifcase#1\or         % The letters I, O
  a\or b\or c\or d\or e\or f\or   % are skipped (see "ГОСТ Р 2.105-2019"
  g\or h\or j\or k\or l\or m\or   % p. 6.3.5)
  n\or p\or q\or r\or s\or t\or
  u\or v\or w\or x\or y\or z\else\@ctrerr\fi}
\def\@Alph#1{\ifcase#1\or
  A\or B\or C\or D\or E\or F\or
  G\or H\or J\or K\or L\or M\or
  N\or P\or Q\or R\or S\or T\or
  U\or V\or W\or X\or Y\or Z\else\@ctrerr\fi}
\makeatother

%
% Lists
%

\usepackage{enumitem}

% Teach "enumitem" package the Russian alphabet for enumerations
\makeatletter
\AddEnumerateCounter{\asbuk}{\russian@alph}{щ}
\AddEnumerateCounter{\Asbuk}{\russian@Alph}{Ж}
\makeatother

% Set common settings for all lists
\setlist{labelindent=\parindent,leftmargin=*,listparindent=\parindent,topsep=0pt,partopsep=0pt,parsep=\parskip,itemsep=0pt}

% Set additional settings for unordered lists
\setlist[itemize]{label={--}}

% Set additional settings for ordered lists
\setlist[enumerate, 1]{label={\arabic*)}}
\setlist[enumerate, 2]{label={\asbuk*)}}
\setlist[enumerate, 3]{label={\arabic*)}}
\setlist[enumerate, 4]{label={\asbuk*)}}

% Provide the "\tightlist" command for Pandoc. I made it do nothing because
% I needed all lists to look the same when Pandoc used this command to have
% two different styles of lists (loose and tight)
\newcommand{\tightlist}{}

%
% Headings
%

\usepackage{titlesec}

\titleformat{name=\section,numberless}[block]{\filcenter\Large\bfseries}{}{0pt}{}
\titleformat{name=\section}[block]{\filright\Large\bfseries}{\thesection}{0.5em}{}
\titleformat{\subsection}[block]{\filright\large\bfseries}{\thesubsection}{0.5em}{}
\titleformat{\subsubsection}[block]{\filright\normalsize\bfseries}{\thesubsubsection}{0.5em}{}

\titlespacing{name=\section,numberless}{0pt}{3ex}{2ex}
\titlespacing{name=\section}{\parindent}{3ex}{2ex}
\titlespacing{\subsection}{\parindent}{3ex}{2ex}
\titlespacing{\subsubsection}{\parindent}{3ex}{2ex}

% Start a section on a new page
\let\oldsection\section
\def\newsection{\clearpage\oldsection}
\renewcommand{\section}{\newsection}

%
% Figures
%

\usepackage{graphicx}

% Set the default \includegraphics options (tell LaTeX to not upscale images
% that fit and to downscale images that don't; downscaled images will keep their
% aspect ratio and have a width of 3/4 of the current paragraph's width;
% extremely narrow images will probably overflow, therefore you should set their
% height manually by overriding the defaults)
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>0.75\linewidth 0.75\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight \textheight\else\Gin@nat@height\fi}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\makeatother

% Set the default figure placement to [H]ERE (i.e. tell LaTeX to never place
% figures before the paragraphs preceding them in the source code)
\usepackage{float}
\makeatletter
\def\fps@figure{H}
\makeatother

\usepackage{caption}
\DeclareCaptionLabelSeparator{custom}{ --- }
\captionsetup[figure]{
  format=plain,
  labelformat=simple,
  labelsep=custom,
  justification=centering,
  width=0.75\linewidth, % WTF: If \captionsetup didn't have the [figure] option, the \linewidth would be smaller than it should be
  position=below,
  aboveskip=0.5\baselineskip,
  belowskip=-0.5\baselineskip, % WTF: Without this option there is too much vertical space between the caption and the following text
}

\RequirePackage{babel}
\addto\captionsrussian{\renewcommand{\figurename}{Рисунок}}

% Set the vertical spacing before and after figures to the height of a line
\setlength{\textfloatsep}{\baselineskip}
\setlength{\floatsep}{\baselineskip}
\setlength{\intextsep}{\baselineskip}

\counterwithin{figure}{section}


\begin{document}

$body$

\end{document}
